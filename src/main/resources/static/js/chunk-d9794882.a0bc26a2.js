(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d9794882"],{"13d5":function(e,t,l){"use strict";var i=l("23e7"),s=l("d58f").left,a=l("a640"),n=l("ae40"),r=l("2d00"),o=l("605d"),u=a("reduce"),c=n("reduce",{1:0}),d=!o&&r>79&&r<83;i({target:"Array",proto:!0,forced:!u||!c||d},{reduce:function(e){return s(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"3efb":function(e,t,l){"use strict";l.r(t);var i=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("el-card",[l("div",{attrs:{slot:"header"},slot:"header"},[l("el-row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[l("el-col",{attrs:{span:12}},[l("span",[e._v("计分规则管理")]),l("el-select",{staticStyle:{"margin-left":"20px"},model:{value:e.classify,callback:function(t){e.classify=t},expression:"classify"}},e._l(e.classifyOption,(function(e,t){return l("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),l("el-col",{staticClass:"btn-area",attrs:{span:8}},[l("el-dropdown",{staticStyle:{"margin-right":"20px"}},[l("el-button",{attrs:{type:"primary"}},[e._v(" 删除系列积分分类"),l("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),l("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.classifyOption,(function(t,i){return l("el-dropdown-item",{key:i},[l("el-button",{attrs:{type:"text"},on:{click:function(l){return e.deleteClassifyRule(t.value)}}},[e._v("删除"+e._s(t.value)+"系列积分分类")])],1)})),1)],1),l("el-dropdown",{staticStyle:{"margin-right":"20px"}},[l("el-button",{attrs:{type:"primary"}},[e._v(" 新增"),l("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),l("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[l("el-dropdown-item",[l("el-button",{attrs:{type:"text"},on:{click:e.addRule}},[e._v("新增原有计分分类")])],1),l("el-dropdown-item",[l("el-button",{attrs:{type:"text"},on:{click:function(t){e.dialogAddNewClassifyRule=!0}}},[e._v("新增新的计分分类")])],1)],1)],1),l("el-button",{attrs:{type:"primary"},on:{click:e.saveRule}},[e._v("保存")])],1)],1)],1),l("vxe-table",{attrs:{border:"",resizable:"","show-overflow":"",data:e.rulesComputed,"edit-config":{trigger:"dblclick",mode:"cell"},"highlight-hover-row":!0}},[l("vxe-table-column",{attrs:{type:"seq",width:"60"}}),l("vxe-table-column",{attrs:{width:"100",field:"classify",title:"计分分类"}}),l("vxe-table-column",{attrs:{width:"300",field:"reason",title:"计分理由","edit-render":{name:"input",attrs:{type:"text"}}}}),l("vxe-table-column",{attrs:{width:"200",field:"addLimit",title:"加分额度","edit-render":{name:"input",attrs:{type:"text"}}}}),l("vxe-table-column",{attrs:{width:"200",field:"desLimit",title:"扣分额度","edit-render":{name:"input",attrs:{type:"text"}}}}),l("vxe-table-column",{attrs:{field:"illustrate",title:"说明","edit-render":{name:"input",attrs:{type:"text"}}}}),l("vxe-table-column",{attrs:{title:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[l("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteRule(i.id)}}},[e._v("删除")])]}}])})],1),l("el-dialog",{attrs:{visible:e.dialogAddNewClassifyRule,title:"新增新的计分分类规则"},on:{"update:visible":function(t){e.dialogAddNewClassifyRule=t}}},[l("el-form",{attrs:{"label-position":"right","label-width":"100px"}},[l("el-form-item",{attrs:{label:"计分分类："}},[l("el-input",{model:{value:e.newClassifyRule.classify,callback:function(t){e.$set(e.newClassifyRule,"classify",t)},expression:"newClassifyRule.classify"}})],1),l("el-form-item",{attrs:{label:"计分理由："}},[l("el-input",{model:{value:e.newClassifyRule.reason,callback:function(t){e.$set(e.newClassifyRule,"reason",t)},expression:"newClassifyRule.reason"}})],1),l("el-form-item",{attrs:{label:"加分额度："}},[l("el-input",{model:{value:e.newClassifyRule.addLimit,callback:function(t){e.$set(e.newClassifyRule,"addLimit",t)},expression:"newClassifyRule.addLimit"}})],1),l("el-form-item",{attrs:{label:"扣分额度："}},[l("el-input",{model:{value:e.newClassifyRule.desLimit,callback:function(t){e.$set(e.newClassifyRule,"desLimit",t)},expression:"newClassifyRule.desLimit"}})],1),l("el-form-item",{attrs:{label:"说明："}},[l("el-input",{model:{value:e.newClassifyRule.illustrate,callback:function(t){e.$set(e.newClassifyRule,"illustrate",t)},expression:"newClassifyRule.illustrate"}})],1),l("el-form-item",[l("div",{staticClass:"btn-area"},[l("el-button",{attrs:{type:"primary"},on:{click:e.addNewClassifyRule}},[e._v("确定")]),l("el-button",{on:{click:e.cancelAddNewClassifyRule}},[e._v("取消")])],1)])],1)],1)],1)],1)},s=[],a=(l("a4d3"),l("e01a"),l("4de4"),l("d81d"),l("13d5"),l("b64b"),{name:"dashboard",data:function(){return{user:this.$store.state.user,rules:[],classify:"",classifyOption:[],dialogAddNewClassifyRule:!1,newClassifyRule:{classify:"",reason:"",addLimit:"",desLimit:"",illustrate:""}}},methods:{getRule:function(){var e=this,t=new FormData;t.append("userId",this.user.id),this.$api.getRule(t).then((function(t){e.classify=t.data[0].classify,e.rules=t.data,e.classifyOption=Object.keys(e.countClassify(t.data)).map((function(e){return{label:e,value:e}}))}))},saveRule:function(){var e=this;this.$api.saveRule(this.rules).then((function(t){e.$showMsg("success",t.description)}))},countClassify:function(e){return e.reduce((function(e,t){return e[t.classify]=e[t.classify]+1||1,e}),{})},addRule:function(){this.rules.push({classify:this.classify})},deleteRule:function(e){var t=this;this.$confirm("确定删除该规则吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var l=new FormData;l.append("ruleId",e),t.$api.deleteRule(l).then((function(e){t.$showMsg("success",e.description),t.getRules()}))})).catch((function(){t.$showMsg("info","已取消删除")}))},addNewClassifyRule:function(){var e=this;this.$api.addNewClassifyRule(this.newClassifyRule).then((function(t){e.$showMsg("success",t.description),e.getRules(),e.dialogAddNewClassifyRule=!1}))},cancelAddNewClassifyRule:function(){this.dialogAddNewClassifyRule=!1,this.newClassifyRule={classify:"",reason:"",addLimit:"",desLimit:"",illustrate:""}},deleteClassifyRule:function(e){var t=this;this.$confirm("确定删除该系列规则吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var l=new FormData;l.append("classify",e),t.$api.deleteClassifyRule(l).then((function(e){t.$showMsg("success",e.description),t.getRule()}))})).catch((function(){t.$showMsg("info","已取消删除")}))}},computed:{rulesComputed:function(){var e=this;return this.rules.filter((function(t){return t.classify===e.classify}))}},mounted:function(){this.getRule()}}),n=a,r=(l("a4a9"),l("2877")),o=Object(r["a"])(n,i,s,!1,null,"56adde26",null);t["default"]=o.exports},"8ff5":function(e,t,l){},a4a9:function(e,t,l){"use strict";l("8ff5")},d58f:function(e,t,l){var i=l("1c0b"),s=l("7b0b"),a=l("44ad"),n=l("50c4"),r=function(e){return function(t,l,r,o){i(l);var u=s(t),c=a(u),d=n(u.length),f=e?d-1:0,p=e?-1:1;if(r<2)while(1){if(f in c){o=c[f],f+=p;break}if(f+=p,e?f<0:d<=f)throw TypeError("Reduce of empty array with no initial value")}for(;e?f>=0:d>f;f+=p)f in c&&(o=l(o,c[f],f,u));return o}};e.exports={left:r(!1),right:r(!0)}}}]);
//# sourceMappingURL=chunk-d9794882.a0bc26a2.js.map