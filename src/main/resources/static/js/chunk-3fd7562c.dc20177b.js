(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fd7562c"],{"13d5":function(e,t,a){"use strict";var n=a("23e7"),i=a("d58f").left,l=a("a640"),r=a("ae40"),s=a("2d00"),o=a("605d"),p=l("reduce"),u=r("reduce",{1:0}),d=!o&&s>79&&s<83;n({target:"Array",proto:!0,forced:!p||!u||d},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"98cb":function(e,t,a){"use strict";a("d139")},caad:function(e,t,a){"use strict";var n=a("23e7"),i=a("4d64").includes,l=a("44d2"),r=a("ae40"),s=r("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!s},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),l("includes")},d139:function(e,t,a){},d58f:function(e,t,a){var n=a("1c0b"),i=a("7b0b"),l=a("44ad"),r=a("50c4"),s=function(e){return function(t,a,s,o){n(a);var p=i(t),u=l(p),d=r(p.length),c=e?d-1:0,f=e?-1:1;if(s<2)while(1){if(c in u){o=u[c],c+=f;break}if(c+=f,e?c<0:d<=c)throw TypeError("Reduce of empty array with no initial value")}for(;e?c>=0:d>c;c+=f)c in u&&(o=a(o,u[c],c,p));return o}};e.exports={left:s(!1),right:s(!0)}},d659:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("el-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[a("el-col",{attrs:{span:12}},[e._v("部门管理")]),a("el-col",{staticClass:"btn-area",attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogAssignRuleDialog=!0}}},[e._v("为部门分配规则权限")])],1)],1)],1),a("vxe-table",{attrs:{border:"",resizable:"","show-overflow":"",data:e.departments,"highlight-hover-row":!0,"span-method":e.mergeRowMethod,align:"center"}},[a("vxe-table-column",{attrs:{type:"seq",width:"60"}}),a("vxe-table-column",{attrs:{field:"name",title:"部门名"},scopedSlots:e._u([{key:"header",fn:function(){return[e._v(" 部门名 "),a("i",{staticClass:"el-icon-plus pointer",on:{click:e.showDialogAddDepartment}})]},proxy:!0}])}),a("vxe-table-column",{attrs:{field:"affiliate1",title:"子部门"},scopedSlots:e._u([{key:"header",fn:function(){return[e._v(" 子部门 "),a("i",{staticClass:"el-icon-plus pointer",on:{click:e.addAffiliate1}})]},proxy:!0}])}),a("vxe-table-column",{attrs:{field:"affiliate2",title:"子子部门"},scopedSlots:e._u([{key:"header",fn:function(){return[e._v(" 子子部门 "),a("i",{staticClass:"el-icon-plus pointer",on:{click:e.addAffiliate2}})]},proxy:!0}])})],1)],1),a("el-dialog",{attrs:{visible:e.dialogDepartmentVisible,title:"新增部门"},on:{"update:visible":function(t){e.dialogDepartmentVisible=t},close:e.cancelAddDepartment}},[a("el-form",{staticClass:"form-new-department",attrs:{"label-width":"100px","label-position":"left"}},[e.ifAddDepartment?a("el-form-item",{attrs:{label:"部门名："}},[a("el-input",{staticStyle:{width:"50%"},model:{value:e.newDepartment.name,callback:function(t){e.$set(e.newDepartment,"name",t)},expression:"newDepartment.name"}})],1):e._e(),e.ifAddAffiliate1?a("el-form-item",{attrs:{label:"父部门："}},[a("el-select",{model:{value:e.newDepartment.supDepartment,callback:function(t){e.$set(e.newDepartment,"supDepartment",t)},expression:"newDepartment.supDepartment"}},e._l(e.optionComputedAffiliate1,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e.ifAddAffiliate2?a("el-form-item",{attrs:{label:"父父部门："}},[a("el-select",{model:{value:e.newDepartment.supSupDepartment,callback:function(t){e.$set(e.newDepartment,"supSupDepartment",t)},expression:"newDepartment.supSupDepartment"}},e._l(e.optionComputedAffiliate2,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),a("el-form-item",{attrs:{label:"用户名："}},[a("el-input",{model:{value:e.newDepartment.username,callback:function(t){e.$set(e.newDepartment,"username",t)},expression:"newDepartment.username"}})],1),a("el-form-item",{attrs:{label:"密码："}},[a("el-input",{attrs:{type:"password"},model:{value:e.newDepartment.password,callback:function(t){e.$set(e.newDepartment,"password",t)},expression:"newDepartment.password"}})],1),a("el-form-item",{attrs:{label:"部门电话："}},[a("el-input",{model:{value:e.newDepartment.phone,callback:function(t){e.$set(e.newDepartment,"phone",t)},expression:"newDepartment.phone"}})],1),a("el-form-item",[a("div",{staticClass:"btn-area"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addDepartment}},[e._v("确定")]),a("el-button",{on:{click:e.cancelAddDepartment}},[e._v("取消")])],1)])],1)],1),a("el-dialog",{attrs:{visible:e.dialogAssignRuleDialog,title:"为部门分配规则权限"},on:{"update:visible":function(t){e.dialogAssignRuleDialog=t},close:e.cancelDepartmentAddRule}},[a("el-form",{attrs:{"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"选择部门："}},[a("el-select",{model:{value:e.departmentRule.department,callback:function(t){e.$set(e.departmentRule,"department",t)},expression:"departmentRule.department"}},e._l(e.departmentOption,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"计分分类："}},[a("el-select",{model:{value:e.departmentRule.classify,callback:function(t){e.$set(e.departmentRule,"classify",t)},expression:"departmentRule.classify"}},e._l(e.classifyOption,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"选择权限："}},[a("el-checkbox-group",{model:{value:e.departmentRule.ruleCheckList,callback:function(t){e.$set(e.departmentRule,"ruleCheckList",t)},expression:"departmentRule.ruleCheckList"}},e._l(e.ruleCompute,(function(e,t){return a("el-checkbox",{key:t,attrs:{label:e.reason}})})),1)],1),a("el-form-item",[a("div",{staticClass:"btn-area"},[a("el-button",{attrs:{type:"primary"},on:{click:e.departmentAddRule}},[e._v("确定")]),a("el-button",{on:{click:e.cancelDepartmentAddRule}},[e._v("取消")])],1)])],1)],1)],1)},i=[],l=(a("a4d3"),a("e01a"),a("4de4"),a("caad"),a("d81d"),a("13d5"),a("b0c0"),a("1762")),r=a.n(l),s={name:"RuleManage",data:function(){return{user:this.$store.state.user,departments:[],dialogDepartmentVisible:!1,value1:"",ifAddDepartment:!1,ifAddAffiliate1:!1,ifAddAffiliate2:!1,newDepartment:{name:"",supSupDepartment:"",supDepartment:"",username:"",password:"",phone:"",logo:null},dialogAssignRuleDialog:!1,departmentOption:[],classifyOption:[],departmentRule:{department:"",classify:"",ruleCheckList:[]},rules:[]}},methods:{getDepartments:function(){var e=this;this.$api.getDepartments().then((function(t){e.departments=t.data.sort((function(e,t){return e.name.localeCompare(t.name,"zh")}))}))},mergeRowMethod:function(e){var t=e.row,a=e._rowIndex,n=e.column,i=e.visibleData,l=["name","affiliate1"],s=r.a.get(t,n.property);if(s&&l.includes(n.property)){var o=i[a-1],p=i[a+1];if(o&&r.a.get(o,n.property)===s)return{rowspan:0,colspan:0};var u=1;while(p&&r.a.get(p,n.property)===s)p=i[++u+a];if(u>1)return{rowspan:u,colspan:1}}},showDialogAddDepartment:function(){this.dialogDepartmentVisible=!0,this.ifAddDepartment=!0,this.newDepartment.logo=2},addAffiliate1:function(){this.dialogDepartmentVisible=!0,this.ifAddDepartment=!0,this.ifAddAffiliate1=!0,this.newDepartment.logo=3},addAffiliate2:function(){this.dialogDepartmentVisible=!0,this.ifAddDepartment=!0,this.ifAddAffiliate1=!0,this.ifAddAffiliate2=!0,this.newDepartment.logo=4},cancelAddDepartment:function(){this.ifAddDepartment=!1,this.ifAddAffiliate1=!1,this.ifAddAffiliate2=!1,this.dialogDepartmentVisible=!1,this.newDepartment={name:"",affiliate1:"",affiliate2:"",username:"",password:"",phone:"",logo:null}},arrDistinctByProp:function(e,t){var a={};return e.reduce((function(e,n){a[n[t]]||(a[n[t]]=e.push(n));return e}),[])},addDepartment:function(){var e=this;this.$api.addDepartment(this.newDepartment).then((function(t){e.$showMsg("success",t.description),e.getDepartments(),e.cancelAddDepartment()}))},getDepartmentOption:function(){var e=this;this.$api.getDepartmentOption().then((function(t){e.departmentOption=t.data}))},getClassify:function(){var e=this;this.$api.getClassify().then((function(t){e.classifyOption=t.data.map((function(e){return{label:e,value:e}}))}))},getRule:function(){var e=this,t=new FormData;t.append("userId",this.user.id),this.$api.getRule(t).then((function(t){e.rules=t.data}))},departmentAddRule:function(){var e=this;this.$api.departmentAddRule(this.departmentRule).then((function(t){e.$showMsg("success",t.description),e.cancelDepartmentAddRule()}))},cancelDepartmentAddRule:function(){this.dialogAssignRuleDialog=!1,this.departmentRule={department:"",classify:"",ruleCheckList:[]}},getCheckRuleList:function(e){var t=this,a=new FormData;a.append("department",e),this.$api.getCheckRuleList(a).then((function(e){t.departmentRule.ruleCheckList=e.data?e.data:[]}))}},computed:{optionComputedAffiliate1:function(){var e=this;return this.arrDistinctByProp(this.departments,this.ifAddAffiliate2?"affiliate1":"name").map((function(t){return{label:e.ifAddAffiliate2?t.affiliate1:t.name,value:e.ifAddAffiliate2?t.affiliate1:t.name}}))},optionComputedAffiliate2:function(){return this.arrDistinctByProp(this.departments,"name").map((function(e){return{label:e.name,value:e.name}}))},ruleCompute:function(){var e=this;return this.rules.filter((function(t){return t.classify===e.departmentRule.classify}))}},mounted:function(){this.getDepartments(),this.getDepartmentOption(),this.getClassify(),this.getRule()},watch:{"departmentRule.department":function(e,t){e&&this.getCheckRuleList(e)}}},o=s,p=(a("98cb"),a("2877")),u=Object(p["a"])(o,n,i,!1,null,"3e4a17d6",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-3fd7562c.dc20177b.js.map