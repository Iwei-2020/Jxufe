(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d88c947"],{"4dee":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:4}},[a("span",[e._v("教工积分修改记录")])]),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},[a("el-input",{staticClass:"search-input",attrs:{clearable:"",placeholder:"教工编号/姓名(搜索)"},model:{value:e.infoSearch,callback:function(t){e.infoSearch=t},expression:"infoSearch"}}),a("el-select",{staticStyle:{margin:"0 10px"},attrs:{placeholder:"计分分类",clearable:""},model:{value:e.classify,callback:function(t){e.classify=t},expression:"classify"}},e._l(e.classifyOption,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),a("el-select",{staticStyle:{margin:"0 10px"},attrs:{placeholder:"学年",clearable:""},model:{value:e.year,callback:function(t){e.year=t},expression:"year"}},e._l(e.yearOption,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),a("el-date-picker",{attrs:{type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeSearch,callback:function(t){e.timeSearch=t},expression:"timeSearch"}})],1)],1),a("el-row",{staticStyle:{"text-align":"right","margin-top":"20px"}},[1===e.user.logo?a("el-button",{attrs:{type:"primary"},on:{click:e.admitRemoveRecordBatch}},[e._v("批量删除")]):e._e()],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{data:e.recordCompute.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize),border:"","row-key":e.getRowKeys},on:{"selection-change":e.handleSelectionChange}},[1===e.user.logo?a("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0}}):e._e(),a("el-table-column",{attrs:{prop:"tchNo",label:"教工编号"}}),a("el-table-column",{attrs:{prop:"tchName",label:"教工姓名"}}),a("el-table-column",{attrs:{prop:"executorName",label:"计分部门名"}}),a("el-table-column",{attrs:{prop:"classify",label:"计分分类"}}),a("el-table-column",{attrs:{prop:"reason",label:"计分理由",width:"200px"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showAttendanceDialog(t.row.attendanceId)}}},[e._v("对应考勤记录")]):a("span",[e._v(e._s(t.row.remark?t.row.remark:"无")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"addScore",label:"加分"}}),a("el-table-column",{attrs:{prop:"desScore",label:"扣分"}}),a("el-table-column",{attrs:{prop:"year",label:"学年"}}),a("el-table-column",{attrs:{prop:"gmtRecord",label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFilter")(t.row.gmtRecord))+" ")]}}])})],1),a("my-pagination",{attrs:{total:e.recordCompute.length,"current-page":e.currentPage,"page-size":e.pageSize},on:{handleCurrentChange:e.handleCurrentChange,handleSizeChange:e.handleSizeChange}}),a("el-dialog",{attrs:{visible:e.dialogSeeAttendanceVisible},on:{"update:visible":function(t){e.dialogSeeAttendanceVisible=t}}},[a("el-table",{attrs:{data:e.attendance,border:""}},[a("el-table-column",{attrs:{prop:"attDate",label:"日期"}}),a("el-table-column",{attrs:{prop:"timeWork1",label:"上班1打卡时间"}}),a("el-table-column",{attrs:{prop:"workResult1",label:"上班1打卡结果"}}),a("el-table-column",{attrs:{prop:"timeOff1",label:"下班1打卡时间"}}),a("el-table-column",{attrs:{prop:"offResult1",label:"下班1打卡结果"}}),a("el-table-column",{attrs:{prop:"timeWork2",label:"上班2打卡时间"}}),a("el-table-column",{attrs:{prop:"workResult2",label:"上班2打卡结果"}}),a("el-table-column",{attrs:{prop:"timeOff2",label:"下班2打卡时间"}}),a("el-table-column",{attrs:{prop:"offResult2",label:"下班2打卡结果"}})],1),a("div",{staticClass:"btn-area"},[a("el-button",{attrs:{type:"primary"},on:{click:e.closeAttendanceDialog}},[e._v("关闭")])],1)],1)],1)],1)},r=[],l=(a("a4d3"),a("e01a"),a("4de4"),a("d81d"),a("d3b7"),a("6d26")),i={name:"ModifyLog",components:{MyPagination:l["a"]},data:function(){return{user:this.$store.state.user,infoSearch:"",timeSearch:"",classify:"",classifyOption:[],recordList:[{tchNo:"",tchName:"",executorNo:"",executorName:"",classify:"",reason:"",remark:"",addScore:"",desScore:"",gmtRecord:""}],currentPage:1,pageSize:10,loading:!0,dialogSeeAttendanceVisible:!1,attendance:[],yearOption:[],year:"",removeSelection:[]}},methods:{getDepartmentRecord:function(){var e=this,t=new FormData;t.set("userId",this.user.id),this.$api.getDepartmentRecord(t).then((function(t){e.recordList=t.data?t.data:[]})).finally((function(){e.loading=!1}))},handleCurrentChange:function(e){this.currentPage=e},handleSizeChange:function(e){this.pageSize=e},showAttendanceDialog:function(e){var t=this;this.dialogSeeAttendanceVisible=!0;var a=new FormData;a.append("id",e),this.$api.getSpecialAttendance(a).then((function(e){console.log(e.data),t.attendance=e.data?[e.data]:[]}))},closeAttendanceDialog:function(){this.attendance=[],this.dialogSeeAttendanceVisible=!1},getClassify:function(){var e=this;this.$api.getClassify().then((function(t){e.classifyOption=t.data.map((function(e){return{label:e,value:e}}))}))},getYearOption:function(){var e=this;this.$api.getRecordYearOption().then((function(t){e.yearOption=t.data?t.data.map((function(e){return{label:e,value:e}})):[]}))},handleSelectionChange:function(e){this.removeSelection=e.map((function(e){return e.id}))},getRowKeys:function(e){return e.id},admitRemoveRecordBatch:function(){var e=this;this.$confirm("确定删除已选择记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$api.admitRemoveRecordBatch(e.removeSelection).then((function(t){e.$showMsg("success",t.description),e.$refs.table.clearSelection(),e.getDepartmentRecord()}))})).catch((function(){e.$showMsg("info","已取消删除")}))}},mounted:function(){this.getDepartmentRecord(),this.getClassify(),this.getYearOption()},computed:{recordCompute:function(){var e=this;return this.currentPage=1,this.pageSize=10,this.infoSearch||this.classify||this.year||this.timeSearch.length>1?this.recordList.filter((function(t){var a=new Date(t.gmtRecord);return(!e.infoSearch||(t.tchNo===e.infoSearch||t.tchName===e.infoSearch||t.executorNo===e.infoSearch||t.executorName===e.infoSearch))&&(!e.classify||t.classify===e.classify)&&(!(e.timeSearch.length>1)||a.getTime()>=e.timeSearch[0].getTime()&&a.getTime()<=e.timeSearch[1].getTime())&&(!e.year||t.year===e.year)})):this.recordList}}},o=i,c=(a("9cc5"),a("2877")),s=Object(c["a"])(o,n,r,!1,null,"46729336",null);t["default"]=s.exports},"4e89":function(e,t,a){"use strict";a("b459")},"6d26":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"total,sizes,prev,pager,next,jumper",total:e.total,"current-page":e.currentPageDiy,"page-size":e.pageSizeDiy,"page-sizes":[5,10,20,50]},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})},r=[],l=(a("a9e3"),{name:"MyPagination",props:{currentPage:{type:Number,default:1},pageSize:{type:Number,default:10},total:{type:Number,default:0}},data:function(){return{currentPageDiy:1,pageSizeDiy:10}},methods:{handleCurrentChange:function(e){this.$emit("handleCurrentChange",e)},handleSizeChange:function(e){this.$emit("handleSizeChange",e)}},watch:{currentPage:function(e,t){this.currentPageDiy=e},pageSize:function(e,t){this.pageSizeDiy=e}}}),i=l,o=(a("4e89"),a("2877")),c=Object(o["a"])(i,n,r,!1,null,"8756b672",null);t["a"]=c.exports},"9cc5":function(e,t,a){"use strict";a("fb5e")},b459:function(e,t,a){},fb5e:function(e,t,a){}}]);
//# sourceMappingURL=chunk-2d88c947.a85d3fba.js.map